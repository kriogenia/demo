{
  "size": 25,
  "query": {
    "function_score": {
      "query": {
        "dis_max": {
          "queries": [
            {
              "match": {
                "original_title.partial": {
                  "query": "iron mask",
                  "minimum_should_match": "3<-60%"
                }
              }
            },
            {
              "match": {
                "title.partial": {
                  "query": "iron mask",
                  "minimum_should_match": "3<-60%"
                }
              }
            },
            {
              "match_phrase": {
                "original_title.perfect": "iron mask"
              }
            },
            {
              "match_phrase": {
                "title.perfect": "iron mask"
              }
            }
          ]
        }
      },
      "functions": [
        {
          "filter": {
            "term": {
              "type": "movie"
            }
          },
          "weight": 1.5
        },
        {
          "filter": {
            "term": {
              "type": "tvEpisode"
            }
          },
          "weight": 0.1
        },
        {
          "field_value_factor": {
            "field": "num_votes",
            "factor": 0.5,
            "modifier": "log1p",
            "missing": 0
          }
        },
        {
          "field_value_factor": {
            "field": "average_rating",
            "factor": 0.2,
            "modifier": "square",
            "missing": 0
          }
        },
        {
          "gauss": {
            "start_year": {
              "origin": "now",
              "offset": "1825d",
              "scale": "10950d",
              "decay": 0.8
            }
          }
        }
      ],
      "boost_mode": "avg"
    }
  },
  "aggs": {
    "genres": {
      "terms": {
        "field": "genres"
      }
    },
    "type": {
      "terms": {
        "field": "type"
      }
    },
    "year": {
      "date_range": {
        "field": "start_year",
        "ranges": [
          {
            "from": "2010",
            "to": "2020"
          }
        ]
      }
    }
  }
}